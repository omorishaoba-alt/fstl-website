<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FSTL Verification & Guarantee OS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<!-- QRCode -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0b1e3d;
  color: #fff;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 520px;
  margin: auto;
  background: #112a52;
  padding: 20px;
  border-radius: 8px;
}
h1 {
  font-size: 20px;
  text-align: center;
}
label {
  display: block;
  margin-top: 12px;
  font-size: 14px;
}
input, textarea {
  width: 100%;
  padding: 8px;
  margin-top: 4px;
  border-radius: 4px;
  border: none;
}
button {
  margin-top: 15px;
  width: 100%;
  padding: 12px;
  background: #1e90ff;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 15px;
  cursor: pointer;
}
button:disabled {
  background: #555;
}
.notice {
  background: #09162d;
  padding: 10px;
  margin-top: 15px;
  font-size: 13px;
  border-left: 4px solid #1e90ff;
}
.hidden {
  display: none;
}
</style>
</head>

<body>
<div class="container">

<h1>FSTL Verification & Guarantee Test OS</h1>

<div class="notice">
This is a controlled test.  
<strong>No payment. No PDF. No QR.</strong>
</div>

<label>Applicant / Entity Name</label>
<input id="name">

<label>Transaction Description</label>
<textarea id="desc"></textarea>

<label>Email Address</label>
<input id="email">

<label>WhatsApp Number (International format)</label>
<input id="whatsapp">

<label>Payment Reference / Confirmation</label>
<input id="payment">

<button id="verifyBtn">CONFIRM PAYMENT & GENERATE VERIFICATION</button>

<button id="downloadBtn" class="hidden">DOWNLOAD VERIFICATION PDF</button>

<button id="notifyBtn" class="hidden">SEND VERIFICATION MESSAGE</button>

<div id="qr" class="hidden"></div>

</div>

<script>
const { jsPDF } = window.jspdf;

let referenceID = "";
let qrData = "";

document.getElementById("verifyBtn").onclick = function () {
  const name = document.getElementById("name").value.trim();
  const desc = document.getElementById("desc").value.trim();
  const email = document.getElementById("email").value.trim();
  const whatsapp = document.getElementById("whatsapp").value.trim();
  const payment = document.getElementById("payment").value.trim();

  if (!name || !desc || !email || !whatsapp || !payment) {
    alert("All fields including payment confirmation are mandatory.");
    return;
  }

  referenceID = "FSTL-" + Date.now();
  qrData = "FSTL Verification Reference: " + referenceID;

  document.getElementById("downloadBtn").classList.remove("hidden");
  document.getElementById("notifyBtn").classList.remove("hidden");

  alert("Payment confirmed. Verification unlocked.");
};

document.getElementById("downloadBtn").onclick = function () {
  const pdf = new jsPDF();

  pdf.setFontSize(14);
  pdf.text("FIRST STANDARD TITLE LIMITED", 20, 20);
  pdf.setFontSize(11);
  pdf.text("Verification & Guarantee Confirmation", 20, 30);

  pdf.text("Reference ID: " + referenceID, 20, 45);
  pdf.text("Applicant: " + document.getElementById("name").value, 20, 55);
  pdf.text("Transaction:", 20, 65);
  pdf.text(document.getElementById("desc").value, 20, 75);

  pdf.text("Status: VERIFIED", 20, 95);
  pdf.text("Guarantee: Issued subject to FSTL Terms", 20, 105);

  const qrDiv = document.getElementById("qr");
  qrDiv.innerHTML = "";
  new QRCode(qrDiv, {
    text: qrData,
    width: 100,
    height: 100
  });

  setTimeout(() => {
    const qrImg = qrDiv.querySelector("img");
    pdf.addImage(qrImg.src, "PNG", 20, 120, 40, 40);
    pdf.save(referenceID + ".pdf");
  }, 500);
};

document.getElementById("notifyBtn").onclick = function () {
  const refMsg = 
    "FSTL Verification Confirmed.\n" +
    "Reference: " + referenceID + "\n" +
    "Status: VERIFIED\n" +
    "Download your official PDF from the verification page.";

  const email = document.getElementById("email").value;
  const whatsapp = document.getElementById("whatsapp").value;

  const mailLink = "mailto:" + email + "?subject=FSTL Verification&body=" + encodeURIComponent(refMsg);
  const waLink = "https://wa.me/" + whatsapp.replace(/\D/g,'') + "?text=" + encodeURIComponent(refMsg);

  window.open(mailLink, "_blank");
  window.open(waLink, "_blank");
};
</script>

</body>
</html>
