<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FSTL AI Paid Verification</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- jsPDF CDN for PDF receipts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; color:#111; }
nav { background:#000; padding:15px; position:sticky; top:0; }
nav a { color:#fff; margin-right:15px; text-decoration:none; font-weight:bold; }
section { padding:40px 20px; background:#fff; margin-bottom:10px; }
input, button { width:100%; padding:12px; margin-top:10px; font-size:16px; }
button { background:#000; color:#fff; border:none; cursor:pointer; }
#result { margin-top:20px; padding:20px; background:#eee; }
footer { background:#000; color:#fff; text-align:center; padding:20px; font-size:14px; }
label { font-weight:bold; margin-top:10px; display:block; }
</style>
</head>
<body>

<nav>
  <a href="index.html">Home</a>
  <a href="search.html">AI Search</a>
  <a href="verify.html">Verify</a>
  <a href="agents.html">Agents</a>
  <a href="payment.html">Payments</a>
</nav>

<section>
<h2>FSTL AI Paid Verification</h2>
<p>Enter your Reference ID, Agent ID, or Buyer Name to instantly verify a transaction and download a bank-backed digital receipt.</p>

<label for="refID">Reference ID</label>
<input type="text" id="refID" placeholder="FSTL-REF-XXXX">

<label for="agentID">Agent ID</label>
<input type="text" id="agentID" placeholder="FSTL-AGENT-XXXX">

<label for="buyerName">Buyer Name</label>
<input type="text" id="buyerName" placeholder="John Doe">

<button onclick="startVerification()">Submit & Verify</button>

<div id="result"></div>
</section>

<script>
// Example client-side dataset
const transactions = [
  { ref: "FSTL-REF-1001", agent: "FSTL-AGENT-01", buyer: "John Doe", status:"Paid" },
  { ref: "FSTL-REF-1002", agent: "FSTL-AGENT-02", buyer: "Jane Doe", status:"Pending" },
  { ref: "FSTL-REF-1003", agent: "FSTL-AGENT-03", buyer: "Alice Smith", status:"Paid" }
];

function startVerification() {
  const ref = document.getElementById('refID').value.trim();
  const agent = document.getElementById('agentID').value.trim();
  const buyer = document.getElementById('buyerName').value.trim();
  const resultDiv = document.getElementById('result');

  if(!ref && !agent && !buyer) {
    alert('Please enter at least one field to search');
    return;
  }

  // Filter dataset based on input
  const found = transactions.find(t =>
    (ref && t.ref === ref) ||
    (agent && t.agent === agent) ||
    (buyer && t.buyer.toLowerCase() === buyer.toLowerCase())
  );

  if(found) {
    resultDiv.innerHTML = `
      ✅ Transaction Verified!<br>
      <strong>Reference ID:</strong> ${found.ref}<br>
      <strong>Agent ID:</strong> ${found.agent}<br>
      <strong>Buyer Name:</strong> ${found.buyer}<br>
      <strong>Status:</strong> ${found.status}<br>
      <button onclick="downloadPDF('${found.ref}','${found.agent}','${found.buyer}','${found.status}')">Download Styled PDF Receipt</button>
    `;
  } else {
    resultDiv.innerHTML = '❌ No matching transaction found. Check your Reference ID, Agent ID, or Buyer Name.';
  }
}

function downloadPDF(ref, agent, buyer, status) {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // FSTL Branding
  doc.setFontSize(22);
  doc.setTextColor(0,0,128);
  doc.text("First Standard Title Limited (FSTL)", 20, 30);

  doc.setFontSize(16);
  doc.setTextColor(0,0,0);
  doc.text("Digital Verification Receipt", 20, 45);

  doc.setFontSize(12);
  doc.text(`Reference ID: ${ref}`, 20, 60);
  doc.text(`Agent ID: ${agent}`, 20, 68);
  doc.text(`Buyer Name: ${buyer}`, 20, 76);
  doc.text(`Status: ${status}`, 20, 84);
  doc.text(`Verified by: FSTL AI Layer`, 20, 92);
  doc.text(`Bank Confirmed: Yes`, 20, 100);
  doc.text(`Date: ${new Date().toLocaleString()}`, 20, 108);

  doc.setDrawColor(0,0,0);
  doc.line(20, 112, 190, 112);

  doc.setFontSize(10);
  doc.text("Thank you for using FSTL. This receipt is bank-backed and AI-verified.", 20, 120);

  doc.save(`${ref}-FSTL-Receipt.pdf`);
}
</script>

<footer>
© First Standard Title Limited (FSTL) – The Redeemer of Shadows & Guardian of Truth
</footer>

</body>
</html>
